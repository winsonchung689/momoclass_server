<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xue.repository.dao.UserMapper">

  <resultMap id="BaseResultMap" type="com.xue.entity.model.Message">
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="password" jdbcType="VARCHAR" property="password" />
    <result column="photo" property="photo" javaType="[B" jdbcType="BLOB"/>
  </resultMap>
  <resultMap id="BaseSchedule" type="com.xue.entity.model.Schedule">
    <result column="add_date" jdbcType="VARCHAR" property="add_date" />
    <result column="student_name" jdbcType="VARCHAR" property="student_name" />
  </resultMap>
  <resultMap id="BaseUser" type="com.xue.entity.model.User">
    <result column="nick_name" jdbcType="VARCHAR" property="nick_name" />
    <result column="role" jdbcType="VARCHAR" property="role" />
  </resultMap>
  <resultMap id="BaseLesson" type="com.xue.entity.model.Lesson">
    <result column="student_name" jdbcType="VARCHAR" property="student_name" />
  </resultMap>
  <resultMap id="BaseSignUp" type="com.xue.entity.model.SignUp">
    <result column="student_name" jdbcType="VARCHAR" property="student_name" />
  </resultMap>
  <resultMap id="BaseGift" type="com.xue.entity.model.Gift">
    <result column="student_name" jdbcType="VARCHAR" property="student_name" />
  </resultMap>
  <resultMap id="BaseArrangement" type="com.xue.entity.model.Arrangement">
    <result column="dayofweek" jdbcType="VARCHAR" property="dayofweek" />
  </resultMap>
  <resultMap id="BaseLeave" type="com.xue.entity.model.Leave">
    <result column="student_name" jdbcType="VARCHAR" property="student_name" />
  </resultMap>
  <resultMap id="BaseAllCount" type="com.xue.entity.model.AllCount">
    <result column="student_count" jdbcType="INTEGER" property="student_count" />
  </resultMap>
  <resultMap id="BaseGoodsList" type="com.xue.entity.model.GoodsList">
    <result column="goods_name" jdbcType="VARCHAR" property="goods_name" />
  </resultMap>
  <resultMap id="BaseOrder" type="com.xue.entity.model.Order">
    <result column="nick_name" jdbcType="VARCHAR" property="nick_name" />
  </resultMap>
  <resultMap id="BaseNote" type="com.xue.entity.model.Note">
    <result column="student_name" jdbcType="VARCHAR" property="student_name" />
  </resultMap>





  <!-- 获取全部 -->
  <select id="getMessage" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
      select id,student_name,'null' photo,comment,create_time,class_name,class_target,studio,class_target_bak,duration,positive,discipline,happiness from class_comment where class_target_bak = #{param4} and studio = #{param1} and delete_status = 0 order by create_time desc limit #{param2},#{param3};
  </select>

  <!-- 获取全部 -->
  <select id="getMessageByName" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,'null' photo,comment,create_time,class_name,class_target,studio from class_comment where class_target_bak ='课评' and student_name = #{param1} and studio = #{param2} and delete_status = 0 order by create_time desc limit #{param3},#{param4};
  </select>

  <!-- 获取全部 -->
  <select id="getMessageClient" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,'null' photo,comment,create_time,class_name,class_target,studio from class_comment where class_target_bak ='课评' and delete_status = 0 and student_name like "%"#{param1}"%" and studio = #{param2} order by create_time desc
  </select>

  <!-- 获取全部 -->
  <select id="getMessageInName" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,'null' photo,comment,create_time,class_name,class_target,studio,duration from class_comment where class_target_bak =#{param5} and delete_status = 0 and find_in_set(student_name,#{param1}) and studio = #{param2} order by create_time desc limit #{param3},#{param4};
  </select>

  <!-- 获取全部 -->
  <select id="getMessageGrowth" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio,duration,uuids from class_comment where class_target_bak ='课评' and delete_status = 0 and find_in_set(student_name,#{param1}) and studio = #{param2} order by create_time desc limit #{param3},#{param4};
  </select>


  <!-- 获取范画 -->
  <select id="getModel" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio,uuids from class_comment where class_target='范画' and delete_status = 0 and studio = #{param1} order by create_time desc limit #{param2},#{param3};
  </select>

  <!-- 获取范画 -->
  <select id="getMamaShare" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio from class_comment where class_target='打卡' and delete_status = 0 order by create_time desc limit #{param1},#{param2};
  </select>

  <!-- 获取广告 -->
  <select id="getAdvertise" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio,uuids from class_comment where class_target='广告' and delete_status = 0 and studio = #{param1} order by create_time desc limit 1
  </select>

  <!-- 获取奖状模板 -->
  <select id="getCertificateModel" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select photo from class_comment where class_target='奖状模板' and class_name=#{param1} and delete_status = 0 order by create_time desc limit 1
  </select>

  <!-- 获取奖状模板 -->
  <select id="getCertificateModelName" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select class_name from class_comment where class_target='奖状模板' and delete_status = 0
  </select>

  <!-- 获取相框模板 -->
  <select id="getFrameModel" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,photo,class_name from class_comment where class_target='相框模板' and studio  in ('MOMO画室',#{param1}) and delete_status = 0  order by id limit #{param2},#{param3}; ;
  </select>

  <!-- 获取课程体系 -->
  <select id="getClassSys" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio,uuids from class_comment where class_target = #{param1} and delete_status = 0 and studio = #{param2} order by create_time desc limit #{param3},#{param4};
  </select>

  <!-- 获取课程体系 -->
  <select id="getUuidById" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,class_target_bak,studio,uuids,uuids_c from class_comment where delete_status = 0 and studio = #{param1} and id =#{param2} ;
  </select>

  <!-- 获取教程列表 -->
  <select id="getCourseList" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio from class_comment where class_target = '教程列表' and delete_status = 0 and studio = #{param1} order by create_time desc limit #{param2},#{param3};
  </select>

  <!-- 获取教程详情 -->
  <select id="getCourseDetail" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio from class_comment where class_target = '教程详情' and delete_status = 0 and studio = #{param1} and class_name = #{param2} order by create_time limit #{param3},#{param4};
  </select>

  <!-- 获取主页 -->
  <select id="getHome" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio,uuids from class_comment where class_target='主页' and delete_status = 0 and studio = #{param1} order by create_time desc limit 1
  </select>

  <!-- 获取奖状 -->
  <select id="getCertificate" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio from class_comment where class_target='奖状' and delete_status = 0 and studio = #{param1} order by create_time desc
  </select>

  <!-- 获取付款码 -->
  <select id="getPaycode" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio from class_comment where class_target='付款码' and delete_status = 0 and student_name = #{param1} order by create_time desc limit 1
  </select>

  <!-- 获取个人奖状 -->
  <select id="getCertificateByName" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio from class_comment where class_target='奖状' and studio = #{param1} and delete_status = 0 and student_name = #{param2} order by create_time desc
  </select>

  <!-- 获取全部 -->
  <select id="getSearch" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,'null' photo,comment,create_time,class_name,class_target,studio from class_comment where (student_name like "%"#{param1}"%" or class_name like "%"#{param1}"%") and class_target_bak =#{param5} and studio = #{param2} and delete_status = 0  order by create_time desc limit #{param3},#{param4};
  </select>

  <!-- 获取详情 -->
  <select id="getDetails" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio,duration,positive,discipline,happiness,mp3_url,uuids,uuids_c from class_comment where id = #{param1} and delete_status = 0
  </select>

  <!-- 获取详情 -->
  <select id="getDetailsUrlByDate" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio,duration,positive,discipline,happiness,mp3_url,uuids,uuids_c from class_comment where studio= #{param1} and cast(replace(replace(duration,':',''),'-','') as signed)=cast(replace(replace(#{param2},':',''),'-','') as signed) and student_name= #{param3} and date_format(create_time, '%Y-%m-%d')= #{param4} and class_target_bak ='课评' and delete_status = 0
  </select>

  <!-- 获取详情 -->
  <select id="getPpt" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,photo,comment,create_time,class_name,class_target,studio from class_comment where class_target = '课件' and delete_status = 0 order by id desc limit #{param1},#{param2};
  </select>

  <!-- 获取学生照片 -->
  <select id="getStudentPhoto" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select id,student_name,'null' photo,comment,create_time,class_name,class_target,studio from class_comment where class_target = '礼品乐园' and delete_status = 0 and student_name =#{param1} and studio =#{param2} order by create_time desc limit 1;
  </select>

  <!-- 删除详情 -->
  <select id="deleteStudentPhoto" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    update class_comment set delete_status = 1 where class_target = '礼品乐园' and student_name =#{param1} and studio =#{param2}
  </select>

  <!-- 删除详情 -->
  <select id="deleteHome" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    update class_comment set delete_status = 1 where class_target = '主页' and studio =#{param1}
  </select>

  <!-- 删除详情 -->
  <select id="deleteMyOrder" parameterType="com.xue.entity.model.Order" resultMap="BaseResultMap">
    update `order` set delete_status = 1 where id = #{param1};
  </select>

  <!-- 删除详情 -->
  <select id="deleteNote" parameterType="com.xue.entity.model.Note" resultMap="BaseResultMap">
    delete from class_note where id = #{param1};
  </select>

  <!-- 删除详情 -->
  <select id="deleteUser" parameterType="com.xue.entity.model.User" resultMap="BaseResultMap">
    update user set delete_status = 1 where id = #{param1};
  </select>


  <!-- 删除详情 -->
  <select id="deliverMyOrder" parameterType="com.xue.entity.model.Order" resultMap="BaseResultMap">
    update `order` set status = 1 where id = #{param1};
  </select>

  <!-- 获取详情 -->
  <select id="deleteComment" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
     update class_comment set delete_status = 1 where id =#{param1} and studio =#{param2}
  </select>

  <!-- 获取详情 -->
  <select id="updateUuids" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    update class_comment set uuids =#{param3} where id =#{param1} and studio =#{param2}
  </select>

  <!-- 获取详情 -->
  <select id="updateUuids_c" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    update class_comment set uuids_c =#{param3} where id =#{param1} and studio =#{param2}
  </select>


  <!-- 删除商品 -->
  <select id="deleteGoodsList" parameterType="com.xue.entity.model.GoodsList" resultMap="BaseResultMap">
    update goods_list set delete_status = 1 where id =#{param1} and studio =#{param2}
  </select>


  <!-- 删除安排 -->
  <select id="deleteArrangement" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update schedule_arrangement set delete_status = 1 where id =#{param1} and studio =#{param2}
  </select>

  <!-- 更改课程名 -->
  <select id="changeClassName" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update schedule_arrangement set class_number =#{param3} where id =#{param1} and studio =#{param2}
  </select>

  <!-- 更改课程名 -->
  <select id="modifyMark" parameterType="com.xue.entity.model.SignUp" resultMap="BaseResultMap">
    update sign_up_record set mark =#{param3} where id =#{param1} and studio =#{param2}
  </select>

  <!-- 更改地址及电话号码 -->
  <select id="updateLocation" parameterType="com.xue.entity.model.User" resultMap="BaseResultMap">
    update user set phone_number =#{param3},location=#{param4} where studio =#{param1} and openid =#{param2}
  </select>

  <!-- 更改用户名 -->
  <select id="updateNewName" parameterType="com.xue.entity.model.User" resultMap="BaseResultMap">
    update user set nick_name =#{param2} where openid =#{param1}
  </select>

  <!-- 更改课程名 -->
  <select id="changeSubjectName" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update schedule_arrangement set subject =#{param3} where id =#{param1} and studio =#{param2}
  </select>

  <!-- 更改课程名 -->
  <select id="changeLimit" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update schedule_arrangement set limits =#{param3} where id =#{param1} and studio =#{param2}
  </select>

  <!-- 更改课程名 -->
  <select id="changeScheduleClassName" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update class_schedule set class_number =#{param4} where class_number =#{param1} and studio =#{param2} and duration =#{param3} and subject =#{param5}
  </select>

  <!-- 更改课程名 -->
  <select id="changeSignUpClassName" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update sign_up_record set class_number =#{param4} where class_number =#{param1} and studio =#{param2} and duration =#{param3} and subject =#{param5}
  </select>


  <!-- 更改课程名 -->
  <select id="changeScheduleSubject" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update class_schedule set subject =#{param4} where subject =#{param1} and studio =#{param2} and duration =#{param3} and class_number =#{param5}
  </select>

  <!-- 更改课程名 -->
  <select id="changeSignUpSubject" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseResultMap">
    update class_schedule set subject =#{param4} where subject =#{param1} and studio =#{param2} and duration =#{param3} and class_number =#{param5}
  </select>

  <!-- 获取详情 -->
  <select id="deleteSignUpRecord" parameterType="com.xue.entity.model.SignUp" resultMap="BaseSignUp">
    update sign_up_record set delete_status = 1 where id =#{param1} and studio =#{param2}
  </select>

  <!-- 获取详情 -->
  <select id="deleteSignUpAllRecord" parameterType="com.xue.entity.model.SignUp" resultMap="BaseSignUp">
    update sign_up_record set delete_status = 1 where student_name =#{param1} and studio =#{param2}
  </select>

  <!-- 获取详情 -->
  <select id="deleteGiftRecord" parameterType="com.xue.entity.model.Gift" resultMap="BaseGift">
    delete from gift_record where id =#{param1} and studio =#{param2}
  </select>

  <!-- 获取详情 -->
  <select id="deleteLeaveAllRecord" parameterType="com.xue.entity.model.Leave" resultMap="BaseLeave">
    update leave_record set delete_status = 1 where student_name =#{param1} and studio =#{param2} and leave_type = #{param3} and subject = #{param4}
  </select>

  <!-- 删除请假记录 -->
  <select id="deleteLeaveRecord" parameterType="com.xue.entity.model.Leave" resultMap="BaseLeave">
    update leave_record set delete_status = 1 where id =#{param1} and studio =#{param2}
  </select>

  <!-- 刪除课程表 -->
  <select id="deleteSchedule" parameterType="com.xue.entity.model.Schedule" resultMap="BaseResultMap">
    update class_schedule set delete_status = 1 where id =#{param1} and studio =#{param2}
  </select>

  <!-- 刪除课程表 -->
  <select id="deleteScheduleByLesson" parameterType="com.xue.entity.model.Schedule" resultMap="BaseResultMap">
    update class_schedule set delete_status = 1 where student_name =#{param1} and studio =#{param2}
  </select>

  <!-- 确认课程 -->
  <select id="confirmSchedule" parameterType="com.xue.entity.model.Schedule" resultMap="BaseResultMap">
    update class_schedule set status = 1 where id =#{param1} and studio =#{param2}
  </select>


  <!-- 获取删除学生 -->
  <select id="deleteLesson" parameterType="com.xue.entity.model.Lesson" resultMap="BaseResultMap">
    update lesson set delete_status = 1 where id =#{param1} and studio =#{param2}
  </select>

  <!-- 获取课程表 -->
  <select id="getClassNumber" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseArrangement">
    select id,dayofweek,class_number,duration,limits,photo,studio from schedule_arrangement where studio = #{param1} and dayofweek =#{param2} and duration =#{param3} and delete_status = 0 order by class_number
  </select>

  <!-- 获取课程表 -->
  <select id="getSchedule" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,class_number,subject,remind from class_schedule where dayofweek(add_date)=#{param1} and studio = #{param2} and subject = #{param3} and student_type ='ordinary' and status = 1 and delete_status = 0 order by duration,subject,class_number
  </select>

  <!-- 获取课程表 -->
  <select id="getScheduleAll" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,class_number,subject,remind from class_schedule where dayofweek(add_date)=#{param1} and studio = #{param2} and student_type ='ordinary' and status = 1 and delete_status = 0 order by duration,subject,class_number
  </select>

  <!-- 获取课程表 -->
  <select id="getScheduleByUser" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,class_number,subject,remind from class_schedule where dayofweek(add_date)=#{param1} and studio = #{param2} and student_name = #{param3} and student_type ='ordinary' and status = 1 and delete_status = 0 order by duration,subject,class_number
  </select>

  <!-- 获取课程表 -->
  <select id="getScheduleDetail" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,status,class_number,subject from class_schedule where dayofweek(add_date)=#{param1} and duration = #{param2} and studio= #{param3} and class_number= #{param4} and subject= #{param5} and student_type ='ordinary' and delete_status = 0 order by duration
  </select>

  <!-- 获取课程表 -->
  <select id="getScheduleByClassOrdinary" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,status,class_number,subject from class_schedule where dayofweek(add_date)=#{param1} and duration = #{param2} and studio= #{param3} and class_number= #{param4} and subject= #{param5} and delete_status = 0 and student_type ='ordinary' order by duration
  </select>

  <!-- 获取课程表 -->
  <select id="getScheduleByClassTransferred" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,status,class_number,subject from class_schedule where add_date = #{param1} and duration = #{param2} and studio= #{param3} and class_number= #{param4} and subject= #{param5} and delete_status = 0 and student_type ='transferred' order by duration
  </select>

  <!-- 获取课程表 -->
  <select id="deleteScheduleByDate" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    update class_schedule set delete_status = 1 where dayofweek(add_date)=#{param1} and duration = #{param2} and studio= #{param3} and class_number= #{param4} and student_type ='ordinary' order by duration
  </select>

  <!-- 获取课插班生 -->
  <select id="getTransfer" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,class_number,subject from class_schedule where add_date = #{param1} and studio = #{param2} and subject = #{param3} and student_type ='transferred' and delete_status = 0 order by duration
  </select>

  <!-- 获取课插班生 -->
  <select id="getTransferAll" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select id,add_date,age,student_name,duration,create_time,studio,update_time,student_type,class_number,subject from class_schedule where add_date = #{param1} and studio = #{param2} and student_type ='transferred' and delete_status = 0 order by duration
  </select>

  <!-- 插入信息 -->
  <insert id="push" parameterType="com.xue.entity.model.Message">
      insert class_comment(student_name,photo,comment,create_time,class_name,class_target,studio,class_target_bak,duration,positive,discipline,happiness,mp3_url,uuids) values(#{student_name},#{photo},#{comment},#{create_time},#{class_name},#{class_target},#{studio},#{class_target_bak},#{duration},#{positive},#{discipline},#{happiness},#{mp3_url},#{uuids})
  </insert>

  <!-- 插入课程表 -->
  <insert id="insertSchedule" parameterType="com.xue.entity.model.Schedule">
    insert class_schedule(add_date,age,student_name,duration,create_time,studio,update_time,student_type,status,class_number,delete_status,subject) values(#{add_date},#{age},#{student_name},#{duration},#{create_time},#{studio},#{update_time},#{student_type},#{status},#{class_number},0,#{subject})
  </insert>

  <!-- 插入订单 -->
  <insert id="insertOrder" parameterType="com.xue.entity.model.Order">
    insert `order`(nick_name,openid,phone_number,location,goods_name,goods_intro,goods_price,studio,create_time) values(#{nick_name},#{openid},#{phone_number},#{location},#{goods_name},#{goods_intro},#{goods_price},#{studio},#{create_time})
  </insert>


  <!-- 插入签到记录 -->
  <insert id="insertSignUp" parameterType="com.xue.entity.model.SignUp">
    insert sign_up_record(student_name,create_time,studio,sign_time,mark,duration,count,class_number,subject,teacher) values(#{student_name},#{create_time},#{studio},#{sign_time},#{mark},#{duration},#{count},#{class_number},#{subject},#{teacher})
  </insert>

  <!-- 插入请假记录 -->
  <insert id="insertLeave" parameterType="com.xue.entity.model.Leave">
    insert leave_record(student_name,date_time,studio,create_time,duration,leave_type,mark_leave,subject) values(#{student_name},#{date_time},#{studio},#{create_time},#{duration},#{leave_type},#{mark_leave},#{subject})
  </insert>

  <!-- 插入课程安排 -->
  <insert id="insertArrangement" parameterType="com.xue.entity.model.Arrangement">
    insert schedule_arrangement(dayofweek,class_number,duration,limits,photo,studio,delete_status,subject) values(#{dayofweek},#{class_number},#{duration},#{limits},#{photo},#{studio},0,#{subject})
  </insert>

  <!-- 插入商品列表 -->
  <insert id="insertGoodsList" parameterType="com.xue.entity.model.GoodsList">
    insert goods_list(goods_name,goods_intro,goods_price,create_time,studio,photo) values(#{goods_name},#{goods_intro},#{goods_price},#{create_time},#{studio},#{photo})
  </insert>

  <!-- 获取全部 -->
  <select id="getGoodsList" parameterType="com.xue.entity.model.GoodsList" resultMap="BaseGoodsList">
    select id,goods_name,goods_intro,goods_price,create_time,studio,photo from goods_list where studio = #{param1} and delete_status = 0 order by create_time desc limit #{param2},#{param3};
  </select>

  <!-- 查找课程表 -->
  <select id="getArrangement" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseArrangement">
    select id,dayofweek,class_number,duration,limits,photo,studio,subject from schedule_arrangement where studio = #{param1} and dayofweek =#{param2} and subject =#{param3}  and delete_status = 0 order by duration
  </select>

  <!-- 查找订单 -->
  <select id="getMyOrder" parameterType="com.xue.entity.model.Order" resultMap="BaseOrder">
    select id,nick_name,openid,phone_number,location,goods_name,goods_intro,goods_price,studio,create_time,status from `order` where studio = #{param1} and openid =#{param2} and delete_status = 0 order by create_time
  </select>

  <!-- 查找全部订单 -->
  <select id="getAllOrder" parameterType="com.xue.entity.model.Order" resultMap="BaseOrder">
    select id,nick_name,openid,phone_number,location,goods_name,goods_intro,goods_price,studio,create_time,status from `order` where studio = #{param1} and delete_status = 0 order by status,openid,create_time
  </select>

  <!-- 查找课程表 -->
  <select id="getArrangementAll" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseArrangement">
    select id,dayofweek,class_number,duration,limits,photo,studio,subject from schedule_arrangement where studio = #{param1} and dayofweek =#{param2} and delete_status = 0 order by duration
  </select>

  <!-- 查找课程表 -->
  <select id="getArrangementByDate" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseArrangement">
    select id,dayofweek,class_number,duration,limits,photo,studio,subject from schedule_arrangement where studio = #{param1} and dayofweek =#{param2} and class_number =#{param3} and duration =#{param4} and subject =#{param5} and delete_status = 0 order by duration
  </select>

  <!-- 查找请假记录 -->
  <select id="getLeaveRecord" parameterType="com.xue.entity.model.Leave" resultMap="BaseLeave">
    select id,student_name,date_time,studio,create_time,duration,leave_type,mark_leave,subject from leave_record where student_name =#{param1} and studio = #{param2} and leave_type = #{param3} and subject = #{param4} and delete_status = 0 order by date_time
  </select>

  <!-- 发放礼物记录 -->
  <insert id="insertGift" parameterType="com.xue.entity.model.Gift">
    insert gift_record(student_name,gift_name,create_time,expired_time,studio,gift_amount,status) values(#{student_name},#{gift_name},#{create_time},#{expired_time},#{studio},#{gift_amount},#{status})
  </insert>

  <!-- 查找签到记录 -->
  <select id="getSignUp" parameterType="com.xue.entity.model.SignUp" resultMap="BaseSignUp">
    select id,student_name,create_time,studio,sign_time,mark,duration,count,subject from sign_up_record where student_name =#{param1} and delete_status = 0 and studio = #{param2} and subject = #{param3}  order by create_time
  </select>

  <!-- 查找签到记录 -->
  <select id="getStudentByTeacher" parameterType="com.xue.entity.model.SignUp" resultMap="BaseSignUp">
    select id,student_name,create_time,studio,sign_time,mark,duration,count,subject,teacher from sign_up_record where delete_status = 0 and studio = #{param1} and teacher = #{param2}  order by create_time
  </select>

  <!-- 查找签到记录 -->
  <select id="getStudentByTeacherByDuration" parameterType="com.xue.entity.model.SignUp" resultMap="BaseSignUp">
    select id,student_name,create_time,studio,sign_time,mark,duration,count,subject,teacher from sign_up_record where delete_status = 0 and studio = #{param1} and teacher = #{param2} and create_time between #{param3} and #{param4} order by create_time
  </select>

  <!-- 查找签到记录 -->
  <select id="getSignUpByDate" parameterType="com.xue.entity.model.SignUp" resultMap="BaseSignUp">
    select id,student_name,create_time,studio,sign_time,mark,duration from sign_up_record where student_name =#{param1} and delete_status = 0 and studio = #{param2} and create_time=#{param3}  order by create_time
  </select>

  <!-- 查找签到记录 -->
  <select id="getSignUpByDateDuration" parameterType="com.xue.entity.model.SignUp" resultMap="BaseSignUp">
    select id,student_name,create_time,studio,sign_time,mark,duration from sign_up_record where student_name =#{param1} and studio = #{param2} and create_time=#{param3} and delete_status = 0 and duration=#{param4} order by create_time
  </select>

  <!-- 查找请假记录 -->
  <select id="getLeaveByDateDuration" parameterType="com.xue.entity.model.Leave" resultMap="BaseLeave">
    select id,student_name,date_time,studio,create_time,duration,leave_type from leave_record where student_name =#{param1} and studio = #{param2} and date_time=#{param3} and duration=#{param4} and delete_status = 0 order by create_time
  </select>

  <!-- 查找课评记录 -->
  <select id="getCommentByDate" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select student_name,duration from class_comment where class_target_bak ='课评' and student_name =#{param1} and studio = #{param2} and date_format(create_time, '%Y-%m-%d') = #{param3} and delete_status = 0  order by create_time
  </select>

  <!-- 查找课评记录 -->
  <select id="getCommentByDateDuration" parameterType="com.xue.entity.model.Message" resultMap="BaseResultMap">
    select student_name,duration from class_comment where class_target_bak ='课评' and student_name =#{param1} and studio = #{param2} and date_format(create_time, '%Y-%m-%d') = #{param3} and cast(replace(replace(duration,':',''),'-','') as signed)=cast(replace(replace(#{param4},':',''),'-','') as signed)  and delete_status = 0 order by create_time
  </select>

  <!-- 查找礼物记录 -->
  <select id="getGift" parameterType="com.xue.entity.model.Gift" resultMap="BaseGift">
    select id,student_name,gift_name,create_time,expired_time,studio,gift_amount,status from gift_record where student_name =#{param1} and studio = #{param2} order by expired_time desc
  </select>

  <!-- 更新课时 -->
  <update id="updateSchedule" parameterType="com.xue.entity.model.Schedule">
    update class_schedule set update_time=#{update_time} where student_name=#{student_name} and studio = #{studio}
  </update>

  <!-- 更新课时 -->
  <update id="updateRemind" parameterType="com.xue.entity.model.Schedule">
    update class_schedule set remind=#{remind} where subject=#{subject} and studio = #{studio} and duration = #{duration} and class_number = #{class_number}
  </update>

  <!-- 更新名字 -->
  <update id="updateScheduleName" parameterType="com.xue.entity.model.Schedule">
    update class_schedule set student_name=#{param1} where student_name=#{param2} and studio = #{param3}
  </update>

  <update id="updateCommentName" parameterType="com.xue.entity.model.Message">
    update class_comment set student_name=#{param1} where student_name=#{param2} and studio = #{param3}
  </update>

  <update id="updateGiftRecordName" parameterType="com.xue.entity.model.Gift">
    update gift_record set student_name=#{param1} where student_name=#{param2} and studio = #{param3}
  </update>

  <update id="updateLessonName" parameterType="com.xue.entity.model.Lesson">
    update lesson set student_name=#{param1} where student_name=#{param2} and studio = #{param3}
  </update>

  <update id="updateSignUpRecordName" parameterType="com.xue.entity.model.SignUp">
    update sign_up_record set student_name=#{param1} where student_name=#{param2} and studio = #{param3}
  </update>

  <!-- 更新课评 -->
  <update id="updateComment" parameterType="com.xue.entity.model.Message">
    update class_comment set class_target=#{class_target},comment=#{comment} where id=#{id} and studio = #{studio}
  </update>

  <!-- 更新课评 -->
  <update id="updateDetailPhoto" parameterType="com.xue.entity.model.Message">
    update class_comment set photo=#{photo},uuids=#{uuids} where id=#{id} and studio = #{studio}
  </update>

  <!-- 更新课时 -->
  <update id="updateGift" parameterType="com.xue.entity.model.Gift">
    update gift_record set status=1 where id=#{param1}
  </update>

  <!-- 插入客户信息 -->
  <insert id="insertUser" parameterType="com.xue.entity.model.User">
    insert user(nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,comment_style,send_time,display,cover) values(#{nick_name},#{student_name},#{role},#{openid},#{create_time},#{avatarurl},#{studio},#{user_type},#{expired_time},#{comment_style},#{send_time},#{display},#{cover})
  </insert>

  <select id="getUser" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select id,nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,coins,comment_style,theme,display,cover,phone_number,location,lessons,subjects,send_time from user where openid =#{param1} and delete_status = 0 order by id desc limit 1
  </select>

  <select id="getUserSendTime" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select id,nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,coins,comment_style,theme,display,cover,phone_number,location,lessons,subjects,send_time from user where studio =#{param1} and role ='boss' and delete_status = 0 order by id desc limit 1
  </select>

  <select id="getUserByOpenid" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select id,nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,coins,comment_style,theme,display,cover,phone_number,location,lessons,subjects from user where openid =#{param1} and delete_status = 0 order by create_time desc
  </select>

  <select id="getUserByStudent" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select id,nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,coins,comment_style,theme,display,cover,phone_number,location,lessons,subjects from user where student_name =#{param1} and studio =#{param2} and delete_status = 0 and role = 'client' order by create_time desc
  </select>

  <select id="getUserByNickName" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select id,nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,coins,comment_style,theme,display,cover,phone_number,location,lessons,subjects from user where (nick_name like "%"#{nick_name}"%" or student_name like "%"#{nick_name}"%" or studio like "%"#{nick_name}"%") and delete_status = 0 order by create_time desc
  </select>

  <select id="getUserByStudio" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select id,nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,coins,comment_style,theme,display,cover,phone_number,location,lessons,subjects from user where  studio =#{param1} and delete_status = 0 order by role
  </select>

  <select id="getAllUser" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select id,nick_name,student_name,role,openid,create_time,avatarurl,studio,user_type,expired_time,coins,comment_style,theme,display,cover,phone_number,location,lessons,subjects,send_time from user where delete_status = 0 order by role
  </select>

  <!-- 更新工作室 -->
  <update id="updateUser" parameterType="com.xue.entity.model.User">
    update user set studio=#{studio}, create_time=#{create_time},role=#{role},send_time=#{send_time} where openid = #{openid} and delete_status = 0
  </update>

  <!-- 更新工作室 -->
  <update id="updateAvatar" parameterType="com.xue.entity.model.User">
    update user set avatarurl=#{avatarurl} where openid = #{openid}
  </update>

  <!-- 更新工作室 -->
  <update id="updateUserDelete" parameterType="com.xue.entity.model.User">
    update user set studio=#{studio}, create_time=#{create_time},role=#{role},send_time=#{send_time},delete_status=0 where openid = #{openid} and delete_status=1 and student_name = #{student_name}
  </update>

  <!-- 更新选课 -->
  <update id="updateBossLessons" parameterType="com.xue.entity.model.User">
    update user set lessons=#{lessons} where openid = #{openid}
  </update>

  <!-- 更新课评风格 -->
  <update id="updateComentStyle" parameterType="com.xue.entity.model.User">
    update user set comment_style=#{comment_style} where studio = #{studio}
  </update>

  <!-- 更新课评风格 -->
  <update id="updateSendTime" parameterType="com.xue.entity.model.User">
    update user set send_time=#{send_time} where studio = #{studio}
  </update>

  <select id="getComentStyle" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select comment_style from user where studio = #{studio} and delete_status = 0 order by create_time limit 1
  </select>

  <select id="getStudio" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select distinct studio from user where delete_status = 0
  </select>

  <select id="getStudioBoss" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select distinct studio from user where delete_status = 0 and role = #{param1}
  </select>

  <select id="getClassNumbers" parameterType="com.xue.entity.model.Schedule" resultMap="BaseSchedule">
    select distinct class_number from class_schedule where studio = #{param1}
  </select>

  <select id="getArrangements" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseArrangement">
    select distinct dayofweek,class_number,duration,studio,subject from schedule_arrangement where studio =#{param1} and delete_status = 0 order by dayofweek,duration,subject
  </select>

  <select id="getArrangementById" parameterType="com.xue.entity.model.Arrangement" resultMap="BaseArrangement">
    select distinct dayofweek,class_number,duration,studio,subject from schedule_arrangement where studio =#{param1} and id =#{param2} and delete_status = 0
  </select>

  <select id="getOpenidByNick" parameterType="com.xue.entity.model.User" resultMap="BaseUser">
    select distinct openid from user where student_name =#{param1} and studio = #{param2} and delete_status = 0
  </select>

  <!-- 插入课时 -->
  <insert id="insertNote" parameterType="com.xue.entity.model.Lesson">
    insert class_note(subject,student_name,studio,create_time,note_content) values(#{subject},#{student_name},#{studio},#{create_time},#{note_content})
  </insert>

  <!-- 插入课时 -->
  <insert id="insertLesson" parameterType="com.xue.entity.model.Lesson">
    insert lesson(student_name,total_amount,left_amount,points,create_time,studio,minus,coins,subject) values(#{student_name},#{total_amount},#{left_amount},#{points},#{create_time},#{studio},#{minus},#{coins},#{subject})
  </insert>

  <!-- 获取课时 -->
  <select id="getLesson" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,delete_status,subject from lesson where studio =#{param1} and delete_status = 0 order by left_amount
  </select>

  <select id="getClassNote" parameterType="com.xue.entity.model.Note" resultMap="BaseNote">
    select id,subject,student_name,studio,create_time,note_content from class_note where subject =#{param1} and studio =#{param2} and student_name =#{param3} order by create_time desc
  </select>

  <!-- 获取课时 -->
  <select id="getLessonBySubject" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,delete_status,subject from lesson where studio =#{param1} and subject =#{param2} and delete_status = 0 order by left_amount
  </select>

  <!-- 获取课时 -->
  <select id="getTipsDataUrl" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,subject from lesson where studio =#{param1} and left_amount &lt; #{param2} and subject =#{param3} and delete_status = 0 order by left_amount
  </select>

  <!-- 获取课时 -->
  <select id="getTipsDataUrlAll" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,subject from lesson where studio =#{param1} and left_amount &lt; #{param2} and delete_status = 0 order by left_amount
  </select>


  <!-- 获取总人数 -->
  <select id="getLessonAllCount" parameterType="com.xue.entity.model.Lesson" resultMap="BaseAllCount">
    select count(distinct student_name) student_count,sum(total_amount) total_amount,sum(left_amount) left_amount from lesson where studio =#{param1} and delete_status = 0
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonAllCountBySubject" parameterType="com.xue.entity.model.Lesson" resultMap="BaseAllCount">
    select count(distinct student_name) student_count,sum(total_amount) total_amount,sum(left_amount) left_amount from lesson where studio =#{param1} and subject =#{param2} and delete_status = 0
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonNeedPayCount" parameterType="com.xue.entity.model.Lesson" resultType="java.lang.Integer">
    select count(distinct student_name) from lesson where left_amount &lt; 5 and studio =#{param1} and delete_status = 0;
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonNeedPayCountBySubject" parameterType="com.xue.entity.model.Lesson" resultType="java.lang.Integer">
    select count(distinct student_name) from lesson where left_amount &lt; 5 and studio =#{param1} and subject =#{param2} and delete_status = 0;
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonOweCount" parameterType="com.xue.entity.model.Lesson" resultType="java.lang.Integer">
    select count(distinct student_name) from lesson where left_amount &lt; 0 and studio =#{param1} and delete_status = 0;
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonOweCountBySubject" parameterType="com.xue.entity.model.Lesson" resultType="java.lang.Integer">
    select count(distinct student_name) from lesson where left_amount &lt; 0 and studio =#{param1} and subject =#{param2} and delete_status = 0;
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonAllCountByDay" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select count(distinct student_name) from class_schedule where studio =#{param1} and dayofweek(add_date) =#{param2} and replace(replace(duration,':',''),'-','') =replace(replace(#{param3},':',''),'-','') and class_number =#{param4} and subject =#{param5} and student_type ='ordinary' and status = 1 and delete_status = 0
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonAllCountByDayUnconfirmed" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select count(distinct student_name) from class_schedule where studio =#{param1} and dayofweek(add_date) =#{param2} and replace(replace(duration,':',''),'-','') =replace(replace(#{param3},':',''),'-','') and class_number =#{param4} and subject =#{param5} and student_type ='ordinary' and status = 0 and delete_status = 0
  </select>

  <!-- 获取总人数 -->
  <select id="getLessonAllCountByDayByName" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select count(distinct student_name) from class_schedule where studio =#{param1} and dayofweek(add_date) =#{param2} and replace(replace(duration,':',''),'-','') =replace(replace(#{param3},':',''),'-','') and class_number =#{param4} and subject =#{param5} and student_name =#{param6} and student_type ='ordinary' and status = 1 and delete_status = 0
  </select>

  <!-- 获取总人数 -->
  <select id="getClassesCountAll" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select count(distinct student_name) from class_schedule where studio =#{param1} and student_type ='ordinary' and status = 1 and delete_status = 0
  </select>

  <!-- 获取总人数 -->
  <select id="getClassesCountAllLesson" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select count(student_name) from class_schedule where studio =#{param1} and student_type ='ordinary' and status = 1 and delete_status = 0
  </select>

  <!-- 获取总人数 -->
  <select id="getClassesCountBySubject" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select count(distinct student_name) from class_schedule where studio =#{param1} and subject =#{param2} and student_type ='ordinary' and status = 1 and delete_status = 0
  </select>

  <!-- 获取单月课数 -->
  <select id="getSignUpByMonthAll" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select sum(count) from sign_up_record where studio =#{param1} and date_format(create_time,'%Y-%m') =#{param2} and delete_status = 0
  </select>

  <!-- 获取单月课数 -->
  <select id="getSignUpByMonth" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select sum(count) from sign_up_record where studio =#{param1} and subject =#{param2} and date_format(create_time,'%Y-%m') =#{param3} and delete_status = 0
  </select>


  <!-- 获取总人数 -->
  <select id="getClassesCountBySubjectLesson" parameterType="com.xue.entity.model.Schedule" resultType="java.lang.Integer">
    select count(student_name) from class_schedule where studio =#{param1} and subject =#{param2} and student_type ='ordinary' and status = 1 and delete_status = 0
  </select>

  <!-- 获取今天签到人数 -->
  <select id="getSignUpCountByDay" parameterType="com.xue.entity.model.SignUp" resultType="java.lang.Integer">
    select count(distinct student_name) from sign_up_record where studio =#{param1} and create_time =#{param2} and replace(replace(duration,':',''),'-','') =replace(replace(#{param3},':',''),'-','') and class_number =#{param4} and delete_status = 0
  </select>

  <!-- 获取课时 -->
  <select id="getLessonLikeName" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,subject from lesson where studio =#{param1} and student_name like "%"#{param2}"%" and delete_status = 0 order by left_amount
  </select>

  <!-- 获取课时 -->
  <select id="getLessonLikeNameBySubject" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,subject from lesson where studio =#{param1} and student_name like "%"#{param2}"%" and subject =#{param3} and delete_status = 0 order by left_amount
  </select>

  <!-- 获取课时 -->
  <select id="getLessonInName" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,subject from lesson where studio =#{param1} and find_in_set(student_name,#{param2}) and delete_status = 0 order by left_amount limit #{param3},#{param4};
  </select>

  <!-- 获取课时 -->
  <select id="getLessonInNameBySubject" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,minus,coins,subject from lesson where studio =#{param1} and find_in_set(student_name,#{param2}) and subject =#{param5} and delete_status = 0 order by left_amount limit #{param3},#{param4};
  </select>

  <!-- 获取课时 -->
  <select id="getRating" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,coins,subject from lesson where studio =#{param1} and delete_status = 0 order by points desc limit #{param2},#{param3};
  </select>

  <!-- 获取课时 -->
  <select id="getRatingBySubject" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,coins,subject from lesson where studio =#{param1} and subject =#{param4} and delete_status = 0 order by points desc limit #{param2},#{param3};
  </select>

  <!-- 获取课时 -->
  <select id="getRatingByName" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,subject from lesson where studio =#{param1} and student_name like "%"#{param2}"%" and delete_status = 0 order by student_name limit #{param3},#{param4};
  </select>

  <!-- 获取课时 -->
  <select id="getRatingByNameBySubject" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,create_time,points,studio,subject from lesson where studio =#{param1} and subject =#{param3} and student_name like "%"#{param2}"%" and delete_status = 0 order by student_name limit #{param3},#{param4};
  </select>



  <!-- 更新课时 -->
  <update id="updateLesson" parameterType="com.xue.entity.model.Lesson">
    update lesson set left_amount=#{left_amount}, total_amount=#{total_amount},minus=#{minus},coins=#{coins},subject=#{subject} where student_name=#{student_name} and studio = #{studio} and subject=#{subject} and delete_status = 0
  </update>

  <!-- 更新课时 -->
  <update id="updateLessonSubject" parameterType="com.xue.entity.model.Lesson">
    update lesson set subject=#{param1} where student_name=#{param2} and studio = #{param3} and subject=#{param4} and delete_status = 0
  </update>

  <!-- 更新课时 -->
  <update id="updateLessonAll" parameterType="com.xue.entity.model.Lesson">
    update lesson set coins=#{param1} where studio = #{param2} and delete_status = 0
  </update>

  <!-- 更新用户类型 -->
  <update id="updateUsertype" parameterType="com.xue.entity.model.User">
    update user set role=#{role}, user_type=#{user_type},create_time=#{create_time},expired_time=#{expired_time} where openid=#{openid}
  </update>

  <!-- 更新科目 -->
  <update id="updateSubject" parameterType="com.xue.entity.model.User">
    update user set subjects=#{subjects} where openid=#{openid}
  </update>

  <!-- 更新颜色 -->
  <update id="updateTheme" parameterType="com.xue.entity.model.User">
    update user set theme=#{param1} where openid=#{param2}
  </update>

  <!-- 更新展示视频 -->
  <update id="updatVideoDisplay" parameterType="com.xue.entity.model.User">
    update user set display=#{param2} where studio=#{param1}
  </update>

  <!-- 更新封面权限 -->
  <update id="updatCoverDisplay" parameterType="com.xue.entity.model.User">
    update user set cover=#{param2} where studio=#{param1}
  </update>

  <!-- 续费更新 -->
  <update id="updateUserPay" parameterType="com.xue.entity.model.User">
    update user set role=#{role}, user_type=#{user_type},create_time=#{create_time},expired_time=#{expired_time} where studio=#{studio} and role='boss'
  </update>

  <!-- 获取学生名课时 -->
  <select id="getLessonByName" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,points,create_time,studio,minus,coins,subject from lesson where student_name=#{student_name} and studio = #{studio} and delete_status = 0
  </select>

  <!-- 获取学生名课时 -->
  <select id="getLessonByNameSubject" parameterType="com.xue.entity.model.Lesson" resultMap="BaseLesson">
    select id,student_name,total_amount,left_amount,points,create_time,studio,minus,coins,subject from lesson where student_name=#{student_name} and studio = #{studio} and subject = #{subject} and delete_status = 0
  </select>

  <!-- 更新积分 -->
  <update id="updateLessonPoint" parameterType="com.xue.entity.model.Lesson">
    update lesson set points=#{points} where student_name=#{student_name} and studio = #{studio} and subject = #{subject} and delete_status = 0
  </update>

  <!-- 更新用户金币 -->
  <update id="updateCoins" parameterType="com.xue.entity.model.User">
    update user set coins=#{coins} where openid=#{openid}
  </update>

  <!-- 更新学生名字 -->
  <update id="updateUserStudent" parameterType="com.xue.entity.model.User">
    update user set student_name=#{param1} where student_name=#{param2} and studio=#{param3}
  </update>

  <!-- 用户过期 -->
  <update id="updateUserExpired" parameterType="com.xue.entity.model.User">
    update user set role=#{param1} where studio=#{param2} and role=#{param3}
  </update>


</mapper>